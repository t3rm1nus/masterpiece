<!doctype html>
<html lang="en">
  <head>    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=devic          console.log('üö´ Geolocalizaci√≥n completamente deshabilitada - solo mock');
          
          // Verificar que el mock est√° activo
          setTimeout(() => {
            if (navigator.geolocation === mockGeolocation) {
              console.log('‚úÖ Mock de geolocalizaci√≥n confirmado como activo');
            }
          }, 100);-width, initial-scale=1.0" />    <meta http-equiv="Permissions-Policy" content="geolocation=*, camera=*, microphone=*, payment=*, accelerometer=*, gyroscope=*">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>Vite + React</title>
    
    <!-- Polyfill para Symbol.observable antes de Redux -->
    <script>
      if (typeof Symbol === 'undefined' || !Symbol.observable) {
        if (typeof Symbol === 'undefined') {
          window.Symbol = {};
        }
        Symbol.observable = Symbol.observable || Symbol('observable') || '@@observable';
      }
    </script>    <!-- PayPal SDK Script - Configuraci√≥n adaptada para m√≥viles -->
    <script>      // Variables globales para detecci√≥n de entorno
      window.isLocalhost = window.location.hostname === 'localhost' || 
                          window.location.hostname === '127.0.0.1' || 
                          window.location.hostname === '' ||
                          window.location.port === '5173' ||
                          window.location.port === '3000';
      
      window.isProduction = !window.isLocalhost && 
                           (window.location.hostname.includes('.vercel.app') ||
                            window.location.hostname.includes('.netlify.app') ||
                            window.location.protocol === 'https:');
      
      console.log('üåç Entorno detectado:', {
        hostname: window.location.hostname,
        protocol: window.location.protocol,
        port: window.location.port,
        isLocalhost: window.isLocalhost,
        isProduction: window.isProduction
      });
      
      // Detectar si es m√≥vil para cargar SDK apropiado
      const isMobileDevice = window.innerWidth <= 768 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);      // Configuraci√≥n espec√≠fica para localhost vs producci√≥n
      let sdkUrl;
      if (window.isLocalhost) {
        // En localhost, deshabilitar tarjetas para evitar errores de desarrollo
        sdkUrl = "https://www.paypal.com/sdk/js?client-id=AZDxjDScFpQtjWTOUtWKbyN_bDt4OgqaF4eYXlewfBP4-8aqX3PiV8e1GWU6liB2CUXlkA59kJXE7M6R&components=buttons&disable-funding=venmo,card&currency=EUR&intent=capture&vault=false&locale=es_ES&debug=true";
      } else {
        // En producci√≥n, configuraci√≥n optimizada para m√≥viles y transacciones internacionales
        sdkUrl = "https://www.paypal.com/sdk/js?client-id=AZDxjDScFpQtjWTOUtWKbyN_bDt4OgqaF4eYXlewfBP4-8aqX3PiV8e1GWU6liB2CUXlkA59kJXE7M6R&components=buttons&disable-funding=venmo&currency=EUR&intent=capture&vault=false&locale=es_ES&buyer-country=ES";
      }
      
      const script = document.createElement('script');
      script.src = sdkUrl;
      script.crossOrigin = 'anonymous';
      script.async = true;
      document.head.appendChild(script);      console.log('üí≥ PayPal SDK cargado para:', {
        environment: window.isLocalhost ? 'localhost' : 'production',
        platform: window.isProduction ? 'vercel/netlify' : 'local',
        device: isMobileDevice ? 'm√≥vil' : 'desktop',
        cards: window.isLocalhost ? 'deshabilitadas (desarrollo)' : 'habilitadas (producci√≥n)',
        paypal: 'habilitado',
        geolocation: 'mock con fallback inteligente',
        sdkUrl: sdkUrl.substring(0, 100) + '...'
      });
    </script><!-- Script para configurar permisos antes de PayPal -->
    <script>      // Mock completo de geolocalizaci√≥n para localhost y desarrollo
      (function() {
        const originalGeolocation = navigator.geolocation;
          // En localhost, siempre usar mock para evitar problemas
        // En producci√≥n, SIEMPRE usar mock para evitar violaciones de pol√≠tica
        const shouldUseMock = true; // Siempre usar mock para m√°xima compatibilidad
        
        // Crear un mock completo de geolocalizaci√≥n        const mockGeolocation = {
          getCurrentPosition: function(success, error, options) {
            console.log('üá™üá∏ Mock geolocation activo: Proporcionando ubicaci√≥n de Madrid, Espa√±a');
            if (success) {
              setTimeout(() => {
                success({
                  coords: {
                    latitude: 40.4168,
                    longitude: -3.7038,
                    altitude: null,
                    accuracy: 100,
                    altitudeAccuracy: null,
                    heading: null,
                    speed: null
                  },
                  timestamp: Date.now()
                });
              }, 100);
            }
          },
          watchPosition: function(success, error, options) {
            const id = Math.random();
            if (success) {
              setTimeout(() => {
                success({
                  coords: {
                    latitude: 40.4168,
                    longitude: -3.7038,
                    altitude: null,
                    accuracy: 100,
                    altitudeAccuracy: null,
                    heading: null,
                    speed: null
                  },
                  timestamp: Date.now()
                });
              }, 100);
            }
            return id;
          },
          clearWatch: function(id) {
            console.log('Mock geolocation: clearWatch called with id', id);
          }
        };
        
        // Funci√≥n para interceptar errores de geolocalizaci√≥n y usar fallback
        const interceptGeolocation = function() {
          if (originalGeolocation && originalGeolocation.getCurrentPosition) {
            const originalGetCurrentPosition = originalGeolocation.getCurrentPosition.bind(originalGeolocation);
            
            navigator.geolocation.getCurrentPosition = function(success, error, options) {
              const timeout = options?.timeout || 10000;
              let timeoutId;
              
              // Configurar timeout para usar mock si la geolocalizaci√≥n real falla
              timeoutId = setTimeout(() => {
                console.log('Geolocalizaci√≥n timeout, usando mock');
                mockGeolocation.getCurrentPosition(success, error, options);
              }, Math.min(timeout, 3000)); // M√°ximo 3 segundos de espera
              
              try {
                originalGetCurrentPosition(
                  (position) => {
                    clearTimeout(timeoutId);
                    success(position);
                  },
                  (err) => {
                    clearTimeout(timeoutId);
                    console.log('Error de geolocalizaci√≥n real, usando mock:', err);
                    mockGeolocation.getCurrentPosition(success, error, options);
                  },
                  {
                    ...options,
                    timeout: Math.min(timeout, 3000),
                    enableHighAccuracy: false,
                    maximumAge: 600000 // 10 minutos
                  }
                );
              } catch (e) {
                clearTimeout(timeoutId);
                console.log('Excepci√≥n en geolocalizaci√≥n, usando mock:', e);
                mockGeolocation.getCurrentPosition(success, error, options);
              }
            };
            
            // Interceptar watchPosition tambi√©n
            if (originalGeolocation.watchPosition) {
              const originalWatchPosition = originalGeolocation.watchPosition.bind(originalGeolocation);
              navigator.geolocation.watchPosition = function(success, error, options) {
                try {
                  return originalWatchPosition(
                    success,
                    (err) => {
                      console.log('Error en watchPosition, usando mock:', err);
                      return mockGeolocation.watchPosition(success, error, options);
                    },
                    options
                  );
                } catch (e) {
                  console.log('Excepci√≥n en watchPosition, usando mock:', e);
                  return mockGeolocation.watchPosition(success, error, options);
                }
              };
            }
          }
        };
          // SIEMPRE usar mock para evitar violaciones de pol√≠tica en producci√≥n
        if (shouldUseMock) {
          Object.defineProperty(navigator, 'geolocation', {
            value: mockGeolocation,
            writable: false,
            configurable: false
          });
          console.log('ÔøΩ Geolocalizaci√≥n completamente deshabilitada - solo mock');
        }
      })();// Verificar permisos de geolocalizaci√≥n solo si no estamos en localhost
      if (!window.isLocalhost && navigator.permissions) {
        navigator.permissions.query({name: 'geolocation'}).then(function(result) {
          console.log('Estado de geolocalizaci√≥n:', result.state);
        }).catch(function(err) {
          console.log('No se puede verificar permisos de geolocalizaci√≥n:', err);
        });
      } else if (window.isLocalhost) {
        console.log('üåç Localhost detectado: usando geolocalizaci√≥n mock por defecto');
      }
    </script>
    
    <!-- PayPal Button Initialization Script -->
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        console.log('DOM cargado, inicializando PayPal...');
        
        // Funci√≥n para verificar si estamos en m√≥vil
        function isMobile() {
          return window.innerWidth <= 768;
        }
        
        // Funci√≥n para inicializar PayPal Button
        function initPayPalButton() {
          const container = document.getElementById("paypal-container-MRSQEQV646EPA");
          const wrapper = document.getElementById("paypal-button-wrapper");
          
          console.log('Intentando inicializar PayPal...');
          console.log('M√≥vil:', isMobile());
          console.log('Container encontrado:', !!container);
          console.log('Wrapper encontrado:', !!wrapper);
          console.log('PayPal SDK disponible:', !!window.paypal);
          
          if (!window.paypal) {
            console.log('PayPal SDK no disponible a√∫n, reintentando en 500ms...');
            setTimeout(initPayPalButton, 500);
            return;
          }
          
          if (!container) {
            console.log('Contenedor PayPal no encontrado, reintentando en 500ms...');
            setTimeout(initPayPalButton, 500);
            return;
          }
          
          console.log('‚úÖ Inicializando bot√≥n PayPal...');
          
          if (wrapper) wrapper.classList.add('loading');
          container.innerHTML = '';
            try {            window.paypal.Buttons({
              // Configuraci√≥n para sandbox/testing
              env: 'sandbox', // Cambiar a 'production' cuando tengas permisos
              
              style: {
                layout: 'vertical',
                color: 'gold',
                shape: 'rect',
                label: 'donate',
                height: 44,
                tagline: false
              },              // Configurar m√©todos de pago: solo restringir en localhost
              fundingSource: window.isLocalhost ? window.paypal.FUNDING.PAYPAL : undefined,
              
              createOrder: function(data, actions) {
                // Obtener la cantidad del input o usar 5 EUR por defecto
                let amount = '5.00';
                
                // Buscar el input en ambas versiones (desktop y m√≥vil)
                const amountInputDesktop = document.querySelector('input[name="amount"]#donation-amount');
                const amountInputMobile = document.querySelector('input[name="amount"]#donation-amount-mobile');
                const amountInput = amountInputDesktop || amountInputMobile;
                
                if (amountInput && amountInput.value) {
                  const inputValue = parseFloat(amountInput.value);
                  if (inputValue && inputValue > 0) {
                    amount = inputValue.toFixed(2);
                  }
                }
                  console.log('Creando orden PayPal con cantidad:', amount);
                console.log('Input usado:', amountInput ? amountInput.id : 'ninguno');
                console.log('Entorno:', 'sandbox');                return actions.order.create({
                  intent: 'CAPTURE',
                  purchase_units: [{
                    amount: {
                      value: amount,
                      currency_code: 'EUR'
                    },
                    description: 'Donaci√≥n para Masterpiece'
                  }],
                  application_context: {
                    brand_name: 'Masterpiece',
                    locale: 'es-ES',
                    user_action: 'PAY_NOW',
                    shipping_preference: 'NO_SHIPPING',
                    payment_method: {
                      payee_preferred: 'UNRESTRICTED',
                      payer_selected: 'UNRESTRICTED'
                    },
                    return_url: window.location.origin + window.location.pathname,
                    cancel_url: window.location.origin + window.location.pathname
                  }
                });
              },
              
              onApprove: function(data, actions) {
                console.log('Pago aprobado:', data);
                return actions.order.capture().then(function(details) {
                  console.log('Pago completado:', details);
                  
                  // Mostrar mensaje de √©xito
                  const successMsg = document.createElement('div');
                  successMsg.innerHTML = `
                    <div style="
                      background: #4CAF50;
                      color: white;
                      padding: 15px;
                      border-radius: 8px;
                      text-align: center;
                      margin: 10px 0;
                      font-size: 14px;
                    ">
                      ¬°Gracias por tu donaci√≥n, ${details.payer.name.given_name}! 
                      Tu apoyo significa mucho. ‚òïÔ∏è
                    </div>
                  `;
                  
                  container.parentNode.insertBefore(successMsg, container.nextSibling);
                  
                  // Ocultar el contenedor del bot√≥n temporalmente
                  setTimeout(() => {
                    if (wrapper) wrapper.style.display = 'none';
                    setTimeout(() => {
                      if (wrapper) wrapper.style.display = 'block';
                      successMsg.remove();
                      // Reinicializar el bot√≥n
                      setTimeout(initPayPalButton, 1000);
                    }, 5000);
                  }, 2000);
                });
              },
                onError: function(err) {
                console.error('Error en el pago:', err);
                
                // Manejar errores espec√≠ficos de m√≥viles
                let errorMessage = 'Ha ocurrido un error. Por favor, int√©ntalo de nuevo.';
                
                if (err && err.message) {
                  if (err.message.includes('DOMESTIC_TRANSACTION_REQUIRED')) {
                    errorMessage = 'Error de configuraci√≥n de pagos. Por favor, contacta al soporte.';
                  } else if (err.message.includes('geolocation')) {
                    errorMessage = 'Error de permisos. Por favor, permite la ubicaci√≥n o intenta desde un navegador diferente.';
                  } else if (err.message.includes('INSTRUMENT_DECLINED')) {
                    errorMessage = 'Pago declinado. Por favor, verifica tu m√©todo de pago.';
                  }
                }
                
                const errorMsg = document.createElement('div');
                errorMsg.innerHTML = `
                  <div style="
                    background: #f44336;
                    color: white;
                    padding: 15px;
                    border-radius: 8px;
                    text-align: center;
                    margin: 10px 0;
                    font-size: 14px;
                  ">
                    ${errorMessage}
                  </div>
                `;
                
                container.parentNode.insertBefore(errorMsg, container.nextSibling);
                
                setTimeout(() => {
                  errorMsg.remove();
                }, 5000);
              },
              
              onCancel: function(data) {
                console.log('Pago cancelado:', data);
              }
                }).render('#paypal-container-MRSQEQV646EPA').then(function() {
              console.log('‚úÖ Bot√≥n PayPal renderizado correctamente');
              console.log('Container despu√©s del render:', container);
              console.log('Container tiene contenido:', container.innerHTML.length > 0);
              
              // Marcar como inicializado exitosamente
              paypalInitialized = true;
              
              if (wrapper) {
                wrapper.classList.remove('loading');
                wrapper.classList.add('loaded');
              }
              
              // Aplicar estilos m√≥viles despu√©s de renderizar
              setTimeout(() => {
                applyMobileStyles();
              }, 500);            }).catch(function(err) {
              console.error('‚ùå Error al renderizar bot√≥n PayPal:', err);
              if (wrapper) wrapper.classList.remove('loading');
              
              // Resetear completamente el estado en caso de error
              paypalInitialized = false;
              
              // Si el error es de contenedor removido, intentar una vez m√°s despu√©s de un delay mayor
              if (err.message && err.message.includes('container element removed from DOM')) {
                console.log('Error de contenedor removido, reintentando despu√©s de delay mayor...');
                setTimeout(() => {
                  if (isOnCoffeePage()) {
                    debouncedPayPalInit();
                  }
                }, 2000);
              } else {
                console.log('Otro tipo de error, no se reintentar√° autom√°ticamente');
              }
            });
              } catch (error) {
            console.error('‚ùå Error en inicializaci√≥n PayPal:', error);
            if (wrapper) wrapper.classList.remove('loading');
            
            // Resetear la variable de inicializaci√≥n en caso de error
            paypalInitialized = false;
            
            console.log('Error en try/catch, no se reintentar√° autom√°ticamente');
          }
        }
        
        // Funci√≥n para aplicar estilos m√≥viles
        function applyMobileStyles() {
          if (isMobile()) {
            console.log('Aplicando estilos m√≥viles a PayPal...');
            
            const container = document.getElementById("paypal-container-MRSQEQV646EPA");
            if (!container) return;
            
            // Estilos para el contenedor principal
            container.style.cssText = `
              width: 100% !important;
              max-width: 300px !important;
              margin: 0 auto !important;
              text-align: center !important;
            `;
            
            // Estilos para todos los elementos PayPal
            const paypalElements = container.querySelectorAll('*');
            paypalElements.forEach(element => {
              if (element.tagName === 'DIV' || element.tagName === 'IFRAME') {
                element.style.cssText += `
                  width: 100% !important;
                  max-width: 300px !important;
                  margin: 0 auto !important;
                  border-radius: 8px !important;
                `;
              }
            });
            
            console.log('‚úÖ Estilos m√≥viles aplicados a PayPal');
          }
        }
          // Aplicar estilos en redimensionamiento
        window.addEventListener('resize', () => {
          setTimeout(applyMobileStyles, 100);
        });        // Variable para controlar si PayPal ya est√° inicializado
        let paypalInitialized = false;
        let observerActive = false;
        let initTimeout = null;
        
        // Funci√≥n para verificar si estamos en la p√°gina de coffee
        function isOnCoffeePage() {
          return window.location.hash === '#/coffee' || 
                 window.location.pathname.includes('/coffee') ||
                 document.getElementById("paypal-container-MRSQEQV646EPA") !== null;
        }
        
        // Funci√≥n con debounce para evitar m√∫ltiples inicializaciones
        function debouncedPayPalInit() {
          // Cancelar cualquier inicializaci√≥n pendiente
          if (initTimeout) {
            clearTimeout(initTimeout);
            initTimeout = null;
          }
          
          // Programar nueva inicializaci√≥n con delay
          initTimeout = setTimeout(() => {
            initPayPalWhenReady();
            initTimeout = null;
          }, 800); // M√°s tiempo para que React termine de renderizar
        }
        
        // Funci√≥n para inicializar PayPal solo cuando sea necesario
        function initPayPalWhenReady() {
          if (!isOnCoffeePage()) {
            console.log('No estamos en la p√°gina de coffee, esperando...');
            return;
          }
          
          const container = document.getElementById("paypal-container-MRSQEQV646EPA");
          
          if (!container || !document.body.contains(container)) {
            console.log('Contenedor no disponible en p√°gina de coffee, esperando...');
            return;
          }
          
          // Verificar si el contenedor est√° siendo manipulado por React
          const containerParent = container.parentNode;
          if (!containerParent || !document.body.contains(containerParent)) {
            console.log('Contenedor padre no estable, esperando...');
            setTimeout(debouncedPayPalInit, 500);
            return;
          }
          
          // Verificar si ya hay contenido PayPal en el contenedor
          if (container.children.length > 0 && paypalInitialized) {
            console.log('PayPal ya est√° inicializado y funcionando correctamente');
            return;
          }
          
          // Marcar como en proceso para evitar dobles inicializaciones
          if (paypalInitialized) {
            console.log('PayPal ya est√° en proceso de inicializaci√≥n');
            return;
          }
          
          console.log('‚úÖ Inicializando PayPal en p√°gina de coffee');
          paypalInitialized = true; // Marcar antes de intentar renderizar
          initPayPalButton();
        }
        
        // Observador para detectar cuando estemos en la p√°gina de coffee
        function startPayPalObserver() {
          if (observerActive) return;
          
          observerActive = true;
          
          const observer = new MutationObserver(function(mutations) {
            let containerDetected = false;
            
            mutations.forEach(function(mutation) {
              if (mutation.type === 'childList') {
                // Verificar si se agreg√≥ el contenedor de PayPal
                const container = document.getElementById("paypal-container-MRSQEQV646EPA");
                if (container && !containerDetected && isOnCoffeePage()) {
                  containerDetected = true;
                  console.log('‚úÖ Contenedor PayPal detectado en p√°gina de coffee');
                }
              }
            });
            
            // Solo inicializar una vez por batch de mutaciones
            if (containerDetected) {
              debouncedPayPalInit();
            }
          });
          
          // Observar cambios en el DOM
          observer.observe(document.body, {
            childList: true,
            subtree: true
          });
          
          console.log('Observer de PayPal iniciado');
        }
          // Detectar cambios de ruta en React Router
        function setupRouteListener() {
          // Escuchar cambios en el hash para React Router
          window.addEventListener('hashchange', function() {
            console.log('Cambio de ruta detectado:', window.location.hash);
            if (isOnCoffeePage()) {
              debouncedPayPalInit();
            } else {
              // Limpiar estado cuando sales de la p√°gina de coffee
              paypalInitialized = false;
              if (initTimeout) {
                clearTimeout(initTimeout);
                initTimeout = null;
              }
            }
          });
          
          // Tambi√©n escuchar el evento popstate
          window.addEventListener('popstate', function() {
            console.log('Popstate detectado');
            if (isOnCoffeePage()) {
              debouncedPayPalInit();
            } else {
              paypalInitialized = false;
              if (initTimeout) {
                clearTimeout(initTimeout);
                initTimeout = null;
              }
            }
          });
        }
          // Inicializaci√≥n
        startPayPalObserver();
        setupRouteListener();
          // Funci√≥n global para que React pueda llamarla
        window.initializePayPal = function() {
          console.log('PayPal inicializaci√≥n solicitada desde React');
          debouncedPayPalInit();
        };
        
        // Verificar si ya estamos en la p√°gina de coffee al cargar
        setTimeout(function() {
          if (isOnCoffeePage()) {
            initPayPalWhenReady();
          }
        }, 1000);
      });
    </script>
      <!-- Script para suprimir warnings espec√≠ficos de PayPal que no afectan la funcionalidad -->
    <script>
      // Interceptar y filtrar warnings de PayPal en desarrollo y producci√≥n
      const originalError = console.error;
      const originalWarn = console.warn;
      const originalLog = console.log;      // Interceptar errores espec√≠ficos de undefined + string que vienen de PayPal atomics
      const originalConsoleMethod = console.log;
      const checkPayPalAtomicsError = function(args) {
        // Verificar si es el patr√≥n: undefined 'atomics_error_getting_devlogger_extension'
        if (args.length === 2 && 
            args[0] === undefined && 
            typeof args[1] === 'string' && 
            args[1].includes('atomics_error_getting_devlogger_extension')) {
          return true;
        }
        
        // Verificar si contiene SecurityError de PayPal
        if (args.some(arg => 
          typeof arg === 'object' && 
          arg instanceof Error && 
          arg.message && 
          (arg.message.includes('Blocked a frame with origin') ||
           arg.message.includes('__ATOMIC_EVENTS_DEV_LOGGER__')))) {
          return true;
        }
        
        return false;
      };
      
      // Funci√≥n segura para convertir argumentos a string sin JSON.stringify
      const safeStringify = function(args) {
        try {
          return args.map(arg => {
            if (typeof arg === 'string') return arg;
            if (typeof arg === 'number' || typeof arg === 'boolean') return String(arg);
            if (arg === null || arg === undefined) return String(arg);
            if (arg instanceof Error) return arg.message;
            if (typeof arg === 'object') {
              // Evitar JSON.stringify para objetos DOM y complejos
              if (arg.nodeType || arg.__reactFiber$ || arg._reactInternalFiber) {
                return '[DOM Element]';
              }
              // Para otros objetos, intentar JSON.stringify con fallback
              try {
                return JSON.stringify(arg);
              } catch (e) {
                return '[Complex Object]';
              }
            }
            return String(arg);
          }).join(' ');
        } catch (e) {
          return args.join(' ');
        }
      };
      
      // Sobrescribir console.log para interceptar errores de atomics
      console.log = function(...args) {
        if (checkPayPalAtomicsError(args)) {
          return; // Suprimir estos errores espec√≠ficos
        }
        
        const message = args.join(' ');
        const logString = safeStringify(args);
        
        // Filtrar logs espec√≠ficos de PayPal atomics
        if (message.includes('atomics_error_getting_devlogger_extension') ||
            message.includes('__ATOMIC_EVENTS_DEV_LOGGER__') ||
            logString.includes('atomics_error_getting_devlogger_extension') ||
            logString.includes('__ATOMIC_EVENTS_DEV_LOGGER__')) {
          return; // No mostrar estos logs
        }
        originalLog.apply(console, args);
      };      console.error = function(...args) {
        const message = args.join(' ');
        const errorString = safeStringify(args);
        
        // Filtrar errores espec√≠ficos de PayPal, Redux y Vite que no afectan la funcionalidad
        if (message.includes('ncps_standalone_paylater_ineligible') || 
            message.includes('paylater_ineligible') ||
            message.includes('paypal_js_sdk_v5_unhandled_exception') ||
            message.includes('Cannot read properties of null') ||
            message.includes('classList') ||
            message.includes('renderErrors') ||
            message.includes('geolocation is not allowed') ||
            message.includes('DOMESTIC_TRANSACTION_REQUIRED') ||
            message.includes('scf_unhandled_error') ||
            message.includes('Symbol.observable as defined by Redux') ||
            message.includes('atomics_error_getting_devlogger_extension') ||
            message.includes('__ATOMIC_EVENTS_DEV_LOGGER__') ||
            message.includes('Blocked a frame with origin') ||
            message.includes('cross-origin frame') ||
            message.includes('Converting circular structure to JSON') ||
            message.includes('WebSocket connection') ||
            message.includes('failed to connect to websocket') ||
            message.includes('vite') ||
            errorString.includes('atomics_error_getting_devlogger_extension') ||
            errorString.includes('__ATOMIC_EVENTS_DEV_LOGGER__')) {
          return; // No mostrar estos errores
        }
        originalError.apply(console, args);
      };console.warn = function(...args) {
        const message = args.join(' ');
        const warnString = safeStringify(args);
        
        // Filtrar warnings relacionados con PayPal y Redux
        if (message.includes('ncps_standalone_paylater_ineligible') || 
            message.includes('paylater_ineligible') ||
            message.includes('Pay Later ineligible') ||
            message.includes('paypal_js_sdk') ||
            message.includes('Symbol.observable as defined by Redux') ||
            message.includes('atomics_error_getting_devlogger_extension') ||
            message.includes('__ATOMIC_EVENTS_DEV_LOGGER__') ||
            warnString.includes('atomics_error_getting_devlogger_extension') ||
            warnString.includes('__ATOMIC_EVENTS_DEV_LOGGER__')) {
          return; // No mostrar estos warnings
        }
        originalWarn.apply(console, args);
      };      // Interceptar errores no capturados de PayPal
      window.addEventListener('error', function(event) {
        if (event.error && event.error.message && 
            (event.error.message.includes('Cannot read properties of null') ||
             event.error.message.includes('classList') ||
             event.error.message.includes('renderErrors') ||
             event.error.message.includes('geolocation is not allowed') ||
             event.error.message.includes('DOMESTIC_TRANSACTION_REQUIRED') ||
             event.error.message.includes('scf_unhandled_error') ||
             event.error.message.includes('atomics_error_getting_devlogger_extension') ||
             event.error.message.includes('__ATOMIC_EVENTS_DEV_LOGGER__') ||
             event.error.message.includes('Blocked a frame with origin') ||
             event.error.message.includes('cross-origin frame') ||
             event.error.message.includes('Converting circular structure to JSON') ||
             (event.filename && event.filename.includes('paypal.com')))) {
          event.preventDefault();
          return true;
        }
      });
        // Interceptar espec√≠ficamente errores de geolocalizaci√≥n y atomics
      window.addEventListener('unhandledrejection', function(event) {
        if (event.reason && 
            (event.reason.message?.includes('geolocation') ||
             event.reason.toString().includes('geolocation') ||
             event.reason.message?.includes('DOMESTIC_TRANSACTION_REQUIRED') ||
             event.reason.message?.includes('atomics_error_getting_devlogger_extension') ||
             event.reason.message?.includes('__ATOMIC_EVENTS_DEV_LOGGER__') ||
             event.reason.message?.includes('Blocked a frame with origin') ||
             event.reason.message?.includes('Converting circular structure to JSON'))) {
          console.log('Error de PayPal interceptado y suprimido:', event.reason);
          event.preventDefault();
          return true;
        }
      });
        // Interceptor global para capturar cualquier m√©todo de console usado por PayPal
      ['debug', 'info', 'trace', 'group', 'groupCollapsed'].forEach(method => {
        if (console[method]) {
          const original = console[method];
          console[method] = function(...args) {
            const message = args.join(' ');
            const argString = safeStringify(args);
            
            if (message.includes('atomics_error_getting_devlogger_extension') ||
                message.includes('__ATOMIC_EVENTS_DEV_LOGGER__') ||
                argString.includes('atomics_error_getting_devlogger_extension') ||
                argString.includes('__ATOMIC_EVENTS_DEV_LOGGER__') ||
                checkPayPalAtomicsError(args)) {
              return; // Suprimir estos outputs
            }
            
            original.apply(console, args);
          };
        }
      });
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
