<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + React</title>
    <!-- PayPal SDK Script -->
    <script
      src="https://www.paypal.com/sdk/js?client-id=BAArspW7KDEKg5gwovm8GgU9VyFznam0pK8opZaMXusHM_4ykQsGvLInGZv_vu5J9DDrqXIMHnlBmGWubw&components=hosted-buttons&disable-funding=venmo&currency=EUR" 
      crossorigin="anonymous" 
      async>
    </script>
    
    <!-- PayPal Button Initialization Script -->
    <script>
      document.addEventListener("DOMContentLoaded", (event) => {
        // Función para inicializar PayPal cuando esté disponible
        function initPayPal() {
          const container = document.getElementById("paypal-container-MRSQEQV646EPA");
          const wrapper = document.getElementById("paypal-button-wrapper");
          
          if (window.paypal && window.paypal.HostedButtons && container) {
            // Marcar como cargando
            if (wrapper) wrapper.classList.add('loading');
            
            // Limpiar el contenedor antes de renderizar
            container.innerHTML = '';
            
            try {
              paypal.HostedButtons({
                hostedButtonId: "MRSQEQV646EPA"
              })
              .render("#paypal-container-MRSQEQV646EPA")
              .then(function() {
                // Marcar como cargado cuando termine
                if (wrapper) {
                  wrapper.classList.remove('loading');
                  wrapper.classList.add('loaded');
                }
                console.log('Botón PayPal renderizado correctamente');
                
                // Solo aplicar ajustes básicos de espaciado sin ocultar elementos
                setTimeout(function() {
                  try {
                    // Aplicar espaciado ultra específico al contenedor
                    container.style.display = 'flex';
                    container.style.flexDirection = 'column';
                    container.style.gap = '0.1rem';
                    container.style.lineHeight = '1';
                    
                    // Forzar altura SOLO en el botón principal, no en todos los elementos (excluyendo checkout-button)
                    const buttons = container.querySelectorAll('button:not(#checkout-button), .paypal-button');
                    const iframes = container.querySelectorAll('iframe');
                    
                    buttons.forEach(function(button) {
                      // Verificar que NO sea el checkout-button y que sea un botón PayPal válido
                      if (button.id !== 'checkout-button' &&
                          (button.getAttribute('data-funding-source') === 'paypal' || 
                           button.classList.contains('paypal-button-color-gold') ||
                           button.classList.contains('paypal-button'))) {
                        button.style.setProperty('height', '92px', 'important');
                        button.style.setProperty('min-height', '92px', 'important');
                        button.style.setProperty('max-height', '92px', 'important');
                      }
                    });
                    
                    iframes.forEach(function(iframe) {
                      iframe.style.setProperty('height', '92px', 'important');
                      iframe.style.setProperty('min-height', '92px', 'important');
                      iframe.style.setProperty('max-height', '92px', 'important');
                    });
                    
                    // Aplicar altura específica de 95px SOLO al div principal de PayPal - múltiples intentos
                    const applyMainPayPalHeight = function() {
                      const selectors = [
                        'div[role="link"][data-funding-source="paypal"].paypal-button-color-gold',
                        '.paypal-button-color-gold[data-funding-source="paypal"]',
                        '.paypal-button-color-gold.paypal-button-shape-rect',
                        'div[data-funding-source="paypal"].paypal-button'
                      ];
                      
                      let found = false;
                      selectors.forEach(function(selector) {
                        const mainPayPalDiv = container.querySelector(selector);
                        if (mainPayPalDiv && !found) {
                          mainPayPalDiv.style.setProperty('height', '95px', 'important');
                          mainPayPalDiv.style.setProperty('min-height', '95px', 'important');
                          mainPayPalDiv.style.setProperty('max-height', '95px', 'important');
                          // También forzar con CSS direct
                          mainPayPalDiv.style.cssText += 'height: 95px !important; min-height: 95px !important; max-height: 95px !important;';
                          console.log('Altura de 95px aplicada al div principal PayPal con selector:', selector);
                          found = true;
                        }
                      });
                      
                      if (!found) {
                        console.log('No se encontró el div principal PayPal para aplicar altura de 95px');
                      }
                    };
                    
                    applyMainPayPalHeight();
                    // Reintentar después de un momento por si el elemento se carga después
                    setTimeout(applyMainPayPalHeight, 1000);
                    
                    // Ocultar el botón checkout-button específico sin eliminarlo
                    const hideCheckoutButton = function() {
                      const checkoutButton = document.getElementById('checkout-button');
                      if (checkoutButton) {
                        checkoutButton.style.display = 'none';
                        checkoutButton.style.visibility = 'hidden';
                        checkoutButton.style.opacity = '0';
                        checkoutButton.style.height = '0';
                        checkoutButton.style.overflow = 'hidden';
                        checkoutButton.style.position = 'absolute';
                        checkoutButton.style.left = '-9999px';
                        checkoutButton.style.top = '-9999px';
                        console.log('Botón checkout-button ocultado');
                      }
                      
                      // También buscar por clases en caso de que el ID cambie
                      const checkoutByClass = container.querySelector('button.rect.medium.gold.css-1565878');
                      if (checkoutByClass && checkoutByClass !== checkoutButton) {
                        checkoutByClass.style.display = 'none';
                        checkoutByClass.style.visibility = 'hidden';
                        checkoutByClass.style.opacity = '0';
                        console.log('Botón checkout encontrado por clases y ocultado');
                      }
                    };
                    
                    hideCheckoutButton();
                    // Reintentar la ocultación después de un momento
                    setTimeout(hideCheckoutButton, 1000);
                    setTimeout(hideCheckoutButton, 2000);
                    
                    // Aplicar estilos a la imagen de iconos de tarjetas PayPal
                    const styleCardIconsImage = function() {
                      const selectors = [
                        'img.css-au42bs[src*="Debit_Credit_APM.svg"]',
                        'img.css-au42bs[alt="card icons"]',
                        'img.css-au42bs',
                        '.css-au42bs'
                      ];
                      
                      let found = false;
                      selectors.forEach(function(selector) {
                        const cardIconsImg = container.querySelector(selector);
                        if (cardIconsImg && !found) {
                          // Aplicar estilos directamente - alineación izquierda
                          cardIconsImg.style.setProperty('margin-top', '19px', 'important');
                          cardIconsImg.style.setProperty('display', 'block', 'important');
                          cardIconsImg.style.setProperty('margin-left', '0', 'important');
                          cardIconsImg.style.setProperty('margin-right', 'auto', 'important');
                          cardIconsImg.style.setProperty('text-align', 'left', 'important');
                          cardIconsImg.style.setProperty('width', 'auto', 'important');
                          cardIconsImg.style.setProperty('float', 'left', 'important');
                          
                          // También alinear a la izquierda el contenedor padre
                          if (cardIconsImg.parentElement) {
                            cardIconsImg.parentElement.style.setProperty('text-align', 'left', 'important');
                            cardIconsImg.parentElement.style.setProperty('display', 'flex', 'important');
                            cardIconsImg.parentElement.style.setProperty('justify-content', 'flex-start', 'important');
                            cardIconsImg.parentElement.style.setProperty('align-items', 'center', 'important');
                          }
                          
                          console.log('Estilos aplicados a imagen de iconos PayPal con selector:', selector);
                          found = true;
                        }
                      });
                      
                      if (!found) {
                        console.log('No se encontró la imagen de iconos PayPal para aplicar estilos');
                      }
                    };
                    
                    styleCardIconsImage();
                    // Reintentar múltiples veces por si la imagen se carga después
                    setTimeout(styleCardIconsImage, 1000);
                    setTimeout(styleCardIconsImage, 2000);
                    setTimeout(styleCardIconsImage, 3000);
                    
                    console.log('Espaciado y altura PayPal aplicados de forma selectiva');
                  } catch (e) {
                    console.log('No se pudo modificar el espaciado PayPal:', e);
                  }
                }, 500);
              })
              .catch(function(err) {
                console.warn('Error al renderizar botón PayPal:', err);
                if (wrapper) wrapper.classList.remove('loading');
                // Reintentar después de 2 segundos
                setTimeout(initPayPal, 2000);
              });
            } catch (error) {
              console.warn('Error en inicialización PayPal:', error);
              if (wrapper) wrapper.classList.remove('loading');
              // Reintentar después de 2 segundos
              setTimeout(initPayPal, 2000);
            }
          } else {
            // Reintentar después de 500ms si PayPal no está listo
            setTimeout(initPayPal, 500);
          }
        }
        
        // Inicializar cuando esté listo
        initPayPal();
      });
    </script>
    
    <!-- Script para suprimir warnings específicos de PayPal que no afectan la funcionalidad -->
    <script>
      // Interceptar y filtrar warnings de PayPal en desarrollo
      const originalError = console.error;
      const originalWarn = console.warn;
      
      console.error = function(...args) {
        const message = args.join(' ');
        // Filtrar errores específicos de PayPal que no afectan la funcionalidad
        if (message.includes('ncps_standalone_paylater_ineligible') || 
            message.includes('paylater_ineligible') ||
            message.includes('paypal_js_sdk_v5_unhandled_exception') ||
            message.includes('Cannot read properties of null') ||
            message.includes('classList') ||
            message.includes('renderErrors')) {
          return; // No mostrar estos errores
        }
        originalError.apply(console, args);
      };
      
      console.warn = function(...args) {
        const message = args.join(' ');
        // Filtrar warnings relacionados con PayPal
        if (message.includes('ncps_standalone_paylater_ineligible') || 
            message.includes('paylater_ineligible') ||
            message.includes('Pay Later ineligible') ||
            message.includes('paypal_js_sdk')) {
          return; // No mostrar estos warnings
        }
        originalWarn.apply(console, args);
      };
      
      // Interceptar errores no capturados de PayPal
      window.addEventListener('error', function(event) {
        if (event.error && event.error.message && 
            (event.error.message.includes('Cannot read properties of null') ||
             event.error.message.includes('classList') ||
             event.error.message.includes('renderErrors') ||
             event.filename && event.filename.includes('paypal.com'))) {
          event.preventDefault();
          return true;
        }
      });
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
